on: [push]

jobs:
  custom_test:
    runs-on: ubuntu-latest
    name: Test for cloudos job run
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Run cloudos job run command
        uses: lifebit-ai/action-cloudos-cli@0.3.1
        id: cloudos_job_run
        with:
          apikey:  "${{ secrets.CLOUDOS_TOKEN }}"
          cloudos_url: 'https://staging.lifebit.ai'
          workspace_id: "6323318f39fff801570a1b62"
          project_name: "ci-testing"
          workflow_name: "rnatoy"
          nextflow_profile: "test"
          git_commit: "${{ github.event.pull_request.head.sha }}"
          instance_type: "m5.4xlarge"
          instance_disk: "40"
          cost_limit: "2"
          cloudos_cli_flags: "--spot --wait-completion"


